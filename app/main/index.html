<!doctype html>
<html lang="en">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>MTG Commander APP</title>
        <link rel="stylesheet" type="text/css" href="../../node_modules/angular-material/angular-material.min.css">
        <link rel="stylesheet" type="text/css" href="main.css">
        <script src="https://use.fontawesome.com/e87c62054b.js"></script>                 
        <script src="../../node_modules/angular/angular.js"></script>
        <script src="../../bower_components/angular-drag-and-drop-lists/angular-drag-and-drop-lists.min.js"></script>
        <script src="../../node_modules/angular-animate/angular-animate.min.js"></script>
        <script src="../../node_modules/angular-aria/angular-aria.min.js"></script>
        <script src="../../node_modules/angular-material/angular-material.min.js"></script>
        <script src="../../node_modules/angular-ui-router/release/angular-ui-router.js"></script>
        <script src="../../node_modules/lodash/lodash.min.js"></script>                                                
        <script src="autocomplete.js"></script>
        <script src="app.js"></script>
        <script src="smallSlider.js"></script>  
        <script src="https://use.fontawesome.com/54cb8d98a3.js"></script>      
    </head>
    <body>
      <div ng-controller="MainCtrl">   
        <!-- header: naam app / naam deck -->     
        <div>
          <span>MTG_app</span>
          <input type="text" ng-model="deck.name" placeholder="Name of your deck">
          <span>{{ deck.name }}</span>
          <select name="" id="" ng-options="deck.name for deck in alldecks" ng-model="selectedDeck.deck" ng-change="deckSelected()">            
          </select>
        </div>
        <!-- kaarten zoeken en kaartversie kiezen uit slider -->
        <div style="width:237px; height:340px; float:left; border: solid 1px black;">
          <div ng-include="'autocompletetemplate.html'"></div>           
          <div ng-if="!cardVersions" style="width: {{ cardWidth }}px; height: {{ cardHeight }}px; background-color: green; margin-left: 33px;"></div>            
          <div ng-if="cardVersions"
                small-slider 
                collection="cardVersions"              
                itemheight="{{ cardHeight }}" 
                itemwidth="{{ cardWidth }}"                          
                clickslideritem="selectCardVersion"
                style="position: relative; margin-left: 33px;"></div>          
        </div>
        <!-- opslagplaats voor kaartversies -->
        <div style="float:left; width:{{ (cardWidth + 10) * 4}}px; height:340px; border: solid 1px green; overflow-y: scroll; overflow-x: hidden;">                    
          <p style="height: 27px;">Geselecteerde kaarten</p>                                         
          <ul class="selectedCardsPile"
              style="width:{{ (cardWidth + 10) * 4}}px; height:260px; margin:0px; border: solid 1px red; "
              dnd-horizontal-list="true">
            <li ng-repeat="card in selectedCards"
                dnd-draggable="card"                                  
                dnd-effect-allowed="move">
                <i class="fa fa-trash" aria-hidden="true" ng-click="deleteSelectedCard(card)"></i>
                <img ng-src="http://gatherer.wizards.com/Handlers/Image.ashx?multiverseid={{card.multiverseId}}&type=card" alt="" style="width: {{ cardWidth }}px; height: {{ cardHeight }}px">
              <!-- TODO add img  ng-src="http://gatherer.wizards.com/Handlers/Image.ashx?multiverseid={{card.multiverseId}}&type=card" -->
                <!-- {{ card.name }} -->
            </li>            
          </ul>          
        </div>
        <!-- samenvatting deck -->
        <div style="float: left; width: 282px; height: 340px; border:solid black 1px;">
          <p>
            {{ deck.name }} 
            <span ng-click="saveDeck()">
              <i class="fa fa-floppy-o" aria-hidden="true"></i>
            </span>
          </p>
          <div ng-repeat="pile in deck.piles">
            <p>{{ pile.name }} <span style="float: right;">{{ pileLength(pile); }}</span></p>
            <ul>
              <li ng-repeat="card in pile.cards">{{ card.name}}</li>
            </ul>
          </div>        
        </div>                                         
        <div style="clear: left;"></div>
        <!-- piles maken -->
        <div style="border: 1px solid black">
          <form ng-submit="createPile($event)">  
            <input type="text" placeholder="Name of pile" ng-model="nextPileLabel">
            <input type="submit" value="Make pile">
          </form>
        </div>
        <!-- table met piles -->
        <div>
          <div ng-repeat="pile in deck.piles" class="pile" style="float: left;">
            <p>
              {{pile.name}}
              <span ng-click="changePileView(pile, 'list')">
                <i class="fa fa-list" aria-hidden="true"></i>
              </span>
              <span ng-click="changePileView(pile, 'images')">
                <i class="fa fa-picture-o" aria-hidden="true"></i>
              </span>
              <span ng-click="deletePile(pile)">
                <i class="fa fa-trash" aria-hidden="true"></i>
              </span>
              <span style="float: right;">{{ pileLength(pile); }}</span>
            </p> 
            <ul dnd-list="pile.cards"
                dnd-horizontal-list="true"
                ng-class="getPileClass(pile)">
              <li ng-repeat="card in pile.cards"
                  dnd-draggable="card"
                  dnd-moved="pile.cards.splice($index,1)"                  
                  dnd-effect-allowed="all"
                  dnd-selected="draggedcard = card"
                  ng-class="{'selected': draggedcard ===  card}">
                  <i class="fa fa-trash" aria-hidden="true" ng-click="deleteCard(pile, card)"></i>
                  <img ng-if="pile.view === 'images'" 
                       ng-src="http://gatherer.wizards.com/Handlers/Image.ashx?multiverseid={{card.multiverseId}}&type=card" 
                       alt="" 
                       style="width: {{ cardWidth }}px; height: {{ cardHeight }}px">
                  <span ng-if="pile.view === 'list'">
                    {{ card.name}}
                  </span>
                  <!-- {{card.name}} -->
              </li>
            </ul>            
          </div>                        
        </div>
        </div>              
      </div>         
    </body>

</html>
